<?php
/**
 * Copyright Â© Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */

/**
 * Template for displaying grouped product price
 */
?>
<?php
echo "DEBUG MESSAGE: Entered final_price.phtml";
$totalPrice = 0;

if ($product->getTypeId() === \Magento\GroupedProduct\Model\Product\Type\Grouped::TYPE_CODE) {
    $associatedProducts = $product->getTypeInstance()->getAssociatedProducts($product);

    foreach ($associatedProducts as $associatedProduct) {
        $totalPrice += $associatedProduct->getFinalPrice();
    }

    echo "DEBUG MESSAGE: Total price for grouped product calculated.";
}

?>
<div class="price-box">
    <?php if ($totalPrice > 0) : ?>
    <p class="minimal-price">
        <span class="price-label"><?= $block->escapeHtml(__('Total Price')) ?></span>
        <span class="price"><?= $block->escapeHtml(
            $block->getLayout()->createBlock(\Magento\Framework\Pricing\Helper\Data::class)
                ->currency($totalPrice, true, false)
        ); ?></span>
    </p>
    <?php else : ?>
        <?php echo "DEBUG MESSAGE: No price calculated."; ?>
    <?php endif ?>
</div>
